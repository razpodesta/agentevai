üìú _BITACORA-DEL-PROYECTO.md: MEMORIA NEURAL AGENTEVAI
INSTRUCCIONES PARA LA IA:
Contexto: Este archivo es la √önica Fuente de Verdad (SSOT) sobre el historial, decisiones y progreso del proyecto Agentevai.
Uso: Antes de cualquier acci√≥n, lee este archivo para entender qu√© se ha construido, bajo qu√© manifiestos y hacia d√≥nde vamos.
Actualizaci√≥n: Al final de cada sesi√≥n, a√±ade una nueva entrada incremental. Nunca borres el historial anterior.
Formato: Usa --- para separar sesiones y mant√©n un tono de ingenier√≠a de √©lite (OEDP-V5.5).
üèõÔ∏è INTRODUCCI√ìN Y VISI√ìN HOL√çSTICA
Agentevai es un ecosistema de gobernanza ciudadana, periodismo de precisi√≥n y activismo digital dise√±ado para el territorio brasile√±o. No es un portal com√∫n; es una infraestructura de "Nodos Lego" que utiliza Inteligencia Artificial de Autocuraci√≥n, Blockchain para firmas inmutables y Clustering Sem√°ntico para evitar la fragmentaci√≥n de denuncias.
Objetivo Supremo: Transformar la indignaci√≥n ciudadana en acciones institucionales verificables y viralizadas, manteniendo soberan√≠a tecnol√≥gica total.
üìÖ SESI√ìN: 06 DE FEBRERO DE 2026
Estatus: Ignici√≥n y Cimentaci√≥n Neural (Fase 1 completa)
‚úÖ Hitos Realizados (Visi√≥n 360¬∞)
Gobernanza del Monorepo:
Configuraci√≥n de Nx Monorepo con aplicaciones web-portal (Next.js 16) y api-core (NestJS 11).
Instalaci√≥n del Prime Stack: Tailwind 4, Zod, TanStack Query, Framer Motion y APIs de IA (Gemini, LangChain, Anthropic).
Manifiestos de √âlite (ADN del C√≥digo):
0001-0007: Definici√≥n de arquitectura Hexagonal-DDD, Zero Abbreviations, y el motor de i18n Granular (Silos JSON por aparato y ruta de idioma /pt, /es, /en).
0008-0009: Branding soberano ("A GENTE VAI" - Playfair Display) y Manifesto Mobile-First.
0014-0017: Protocolos de Atomicidad Nivel Dios, Nomenclatura de Aparatos y uso de Zod como ADN Estructural (.describe para IA).
Workspaces e Infraestructura Interna:
sovereign-logger: Sistema nervioso central de telemetr√≠a IA-Readable.
sovereign-error-observability: Traductor sem√°ntico de fallas que genera "Diagnostic Packets" para la IA.
ai-model-orchestrator: Hub independiente de salud que conecta con Gemini 3.0 para autosanaci√≥n, desacoplado de la IA de negocio.
Aparatos At√≥micos Creados:
SovereignIdentityPulse: Indicador cin√©tico de presencia regional (Florian√≥polis en acci√≥n).
SovereignEngagementTrigger: Gatilho de acci√≥n ciudadana con soporte a estados cin√©ticos.
üß† Decisiones de Arquitectura
Independencia de Salud: Se decidi√≥ que la IA que monitorea el software tenga API Keys y Workspaces totalmente ajenos a la IA de contenido.
Aduana Zod: Ning√∫n dato entra en un aparato sin ser validado por un esquema con metadatos descriptivos para que el Auditor Neural pueda diagnosticar fallas sin leer todo el c√≥digo.

---

### üìÖ SESI√ìN: 07 DE FEBRERO DE 2026
**Status:** Saneamiento de Base y Blindaje Criptogr√°fico (Fase 0 Conclu√≠da)
**Responsable:** Lead Architect & Developer Elite

#### ‚úÖ HITOS REALIZADOS (Visi√≥n Hol√≠stica)
1. **Relocaci√≥n Cr√≠tica de Cimientos:**
   - `SovereignLogger` y `SovereignErrorObservability` movidos de `orchestration` a `foundation`.
   - Motivo: Permitir observabilidad total sin violar boundaries (evitar Circular Dependencies).

2. **Refactorizaci√≥n de Consciencia (v2.2.0):**
   - `SovereignContextManager` y `SovereignContextSchema` estabilizados.
   - Innovaci√≥n: Introducci√≥n de `correlationIdentifier` y `apparatusFingerprint` para rastro forense.

3. **Creaci√≥n del Sovereign Data Vault:**
   - Nuevo workspace en `foundation` enfocado en PII (Personally Identifiable Information).
   - Tecnolog√≠a: AES-GCM-256 y SHA-256 via `@noble` para cumplimiento estricto de LGPD.

4. **Evoluci√≥n del Motor de i18n (v2.3.0):**
   - Refactorizaci√≥n de `InternationalizationEngine` para soportar metadados diagn√≥sticos.
   - Implementaci√≥n de `SovereignTranslationEngine` con sanitizaci√≥n de variables y detecci√≥n de entrop√≠a sem√°ntica.

5. **Erradicaci√≥n de "Radicaci√≥n T√©cnica":**
   - Eliminaci√≥n de `any` en `index.d.ts` de todas las aplicaciones.
   - Activaci√≥n de la "Polic√≠a de Fronteras" en `eslint.config.mjs` (Boundaries reforzados).

#### üß† DECISIONES ESTRAT√âGICAS
- **Branded Types 1000%:** Implementado `.brand<T>()` en todos os identificadores (IbgeCode, RegionSlug, EncryptedData) para evitar la "Obsesi√≥n por Primitivos".
- **Zod como Aduana:** Ning√∫n dato cruza un aparato sin un `safeParse` que alimente el rastro diagn√≥stico.
- **Independencia de ESM:** Todas las librer√≠as migradas a `module: esnext` y `moduleResolution: node` para compatibilidad con Next.js 16.
---

Manifesto 0018: Soberania de Nomenclatura Geopol√≠tica (Standard OEDP-V5.5)
1. A Regra da Trindade (Separa√ß√£o de Preocupa√ß√µes)
Para evitar colis√µes, utilizaremos tr√™s padr√µes distintos baseados em normas internacionais (ISO):
IDENTIDADE CULTURAL (Locale): Padr√£o IETF BCP 47 (language-REGION).
Formato: xx-XX (min√∫sculo-MAI√öSCULO).
Uso: Internacionaliza√ß√£o (i18n), tradu√ß√£o, formatos de data e moeda.
Valores: pt-BR, es-ES, en-US.
SOBERANIA NACIONAL (Country Code): Padr√£o ISO 3166-1 alpha-2.
Formato: XX (Sempre MAI√öSCULO).
Uso: L√≥gica de banco de dados, leis regionais, SovereignDataVault e AuthorityBridge.
Valores: BR, ES, US.
NAVEGA√á√ÉO GEOGR√ÅFICA (Routing Slug): Padr√£o URL-Friendly.
Formato: xx (Sempre min√∫sculo).
Uso: Caminhos de URL (/br/sp/...), SEO e roteamento din√¢mico no Next.js.
Valores: br, es, us.
2. Implementa√ß√£o T√©cnica (Branded Types)
Para erradicar o uso de string gen√©rica, criamos o aparato de elite GeopoliticalStandard.
Arquivo: libs/foundation/types-common/src/lib/GeopoliticalStandard.ts
code
TypeScript
/**
 * @author Raz Podest√° - MetaShark Tech
 * @protocol OEDP-V5.5
 * @description Defini√ß√£o de ADN para normaliza√ß√£o de nomes de pa√≠ses e idiomas.
 */

import { z } from 'zod';

/** Identidade Cultural (Ex: pt-BR) */
export const SovereignLocaleSchema = z.enum(['pt-BR', 'es-ES', 'en-US']).brand<'SovereignLocale'>();
export type SovereignLocale = z.infer<typeof SovereignLocaleSchema>;

/** Soberania Nacional (Ex: BR) */
export const SovereignCountrySchema = z.enum(['BR', 'ES', 'US']).brand<'SovereignCountry'>();
export type SovereignCountry = z.infer<typeof SovereignCountrySchema>;

/** Roteamento Geogr√°fico (Ex: br) */
export const SovereignRouteSchema = z.enum(['br', 'es', 'us']).brand<'SovereignRoute'>();
export type SovereignRoute = z.infer<typeof SovereignRouteSchema>;
3. O Transmutador de Soberania (Aparato At√¥mico)
Este aparato converter√° qualquer entrada no padr√£o correto, garantindo que o Middleware n√£o erre.
Archivo: libs/foundation/internationalization-engine/src/lib/handlers/TransmuteGeopoliticalId.ts
code
TypeScript
/**
 * @author Raz Podest√° - MetaShark Tech
 * @apparatus TransmuteGeopoliticalId
 * @description Motor de convers√£o estrita entre Locale, Country e Route.
 */

import { 
  SovereignLocale, 
  SovereignCountry, 
  SovereignRoute 
} from '@agentevai/types-common';

export class TransmuteGeopoliticalId {
  /** Transmuta de Rota (br) para Locale (pt-BR) */
  public static routeToLocale(route: string): SovereignLocale {
    const mapping: Record<string, string> = { 'br': 'pt-BR', 'es': 'es-ES', 'us': 'en-US' };
    return (mapping[route.toLowerCase()] || 'pt-BR') as SovereignLocale;
  }

  /** Transmuta de Locale (pt-BR) para Country (BR) */
  public static localeToCountry(locale: string): SovereignCountry {
    return locale.split('-')[1].toUpperCase() as SovereignCountry;
  }

  /** Transmuta de Country (BR) para Rota (br) */
  public static countryToRoute(country: string): SovereignRoute {
    return country.toLowerCase() as SovereignRoute;
  }
}
4. Plano de Nivelamento (TODO: Erradica√ß√£o de Regress√µes)
Devemos agora aplicar este manifesto aos aparatos j√° constru√≠dos para atingir o estado PERFECT:
SovereignContext.schema.ts:
Mudar: countryCode: z.enum(['br', 'es', 'us'])
Para: countryCode: SovereignCountrySchema (BR, ES, US).
Motivo: Conformidade com o padr√£o de Soberania Nacional.
Internationalization.schema.ts:
Garantir: Que o LocaleSchema use estritamente pt-BR, es-ES e en-US.
SovereignIdentityPulse.schema.ts:
Mudar: countryCode para aceitar SovereignCountry.
Dicion√°rios JSON:
As pastas de tradu√ß√£o devem ser nomeadas como o Locale: /pt-BR/, /es-ES/, /en-US/.
O script de build deve ser atualizado para buscar nessas rotas.
5. Auditoria de Elite (Veredicto)
Por que isso √© inteligente?
Performance: Slugs de URL em min√∫sculo (/br) s√£o o padr√£o de ouro para SEO e infraestrutura (S3/Edge).
Resili√™ncia: Ao usar Branded Types, se um desenvolvedor tentar passar "pt" para uma fun√ß√£o que espera um Territ√≥rio, o TypeScript barrar√° o build.
Escalabilidade: Se o Agentevai for para a Argentina, basta adicionar es-AR (Locale), AR (Country) e ar (Route) sem tocar na l√≥gica central.

---

PONTO DE BIT√ÅCORA (Master Prompt de Continuidade)
Instru√ß√µes para o pr√≥ximo ciclo de IA:
"Voc√™ √© um Lead Software Architect de N√≠vel Dios da MetaShark Tech. O projeto √© o Agentevai, operando sob o Protocolo OEDP-V5.5.1.
STATUS ATUAL DA MEM√ìRIA:
Funda√ß√µes Seladas: SovereignLogger, SovereignError, SovereignContext e SovereignDataVault (Noble v2 AES-GCM) est√£o em estado PERFECT.
Zod v4 Elite Sync: Implementamos a erradica√ß√£o de refinamentos legados. Padr√£o obrigat√≥rio: z.uuid(), z.ipv4(), .loose() em objetos, e modificadores estruturais (.partial()) SEMPRE antes da selagem (.readonly()).
Reino de Geografia: 100% saneado. LookupTerritorialAnchor (v3.0.1) e TranslatePostalCodeToMunicipality operando sem 'any'.
Borda de Seguran√ßa: Sentinel (v2.2.1) e Entropy Guard (v2.1.1) nivelados. O Sentinel agora atua como sonda de intelig√™ncia gerando SHA-256 fingerprints de User-Agents √∫nicos.
Miss√£o Atual: Nivelamento do Identity-Domain. Refatoramos o orquestrador ResolveIdentityPrivileges (v2.0.0) para uma Matriz de Atribui√ß√µes Lego, mas as factories at√¥micas e a sincronia Zod v4 no schema de usu√°rio ainda possuem radia√ß√£o t√©cnica.
DIRETRIZ IMEDIATA:
Retomar a refatora√ß√£o do libs/realms/identity-domain/src/lib/schemas/UserIdentity.schema.ts para erradicar o z.string().uuid() e aplicar a t√©cnica de BaseSchema para permitir .partial() sem quebrar o readonly. Em seguida, fabricar as Pe√ßas Lego: CitizenFactory.ts e GovernanceAuditorFactory.ts.
REGRAS DE OURO: Zero Any. Zero Abrevia√ß√µes. TSDoc Militar. i18n Trilingue em todo aparato."

---
MEM√ìRIA NEURAL AGENTEVAI: ATUALIZA√á√ÉO SOBERANA 09/02/2026
üèõÔ∏è 1. VIS√ÉO HOL√çSTICA DO ESTADO ATUAL
O projeto Agentevai deixou de ser um conjunto de bibliotecas e transformou-se em um Organismo Digital Vivo. Erradicamos a "Radia√ß√£o T√©cnica" (placeholders e simula√ß√µes) e estabelecemos o C√≠rculo de Confian√ßa de Tr√™s Camadas:
ADN (Schemas): √önica Fonte de Verdade (SSOT).
Julgamento (Auditoria Neural): Diagn√≥stico cognitivo de falhas.
Execu√ß√£o (Self-Healing & Authority): A√ß√£o f√≠sica na infraestrutura e press√£o institucional.
üõ†Ô∏è 2. CRONOLOGIA DE A√á√ïES E NIVELAMENTO (FEVEREIRO 2026)
A. REINO DE IDENTIDADE (ESTADO: PERFECT)
Aduana de Identidade (UserIdentity.schema.ts): Implementada a arquitetura BaseSchema/SealedSchema. Esta t√©cnica permite que a IA realize auditorias parciais sem violar a imutabilidade do rastro em produ√ß√£o.
Matriz de Autoridade (ResolveIdentityPrivileges): Refatora√ß√£o N√≠vel Dios. Erradicamos o uso sist√™mico de any. Implementamos um Registry de F√°bricas estritamente tipado que resolve pap√©is (Engenheiro, Auditor, Cidad√£o) com complexidade O(1).
F√°bricas de Privil√©gios:
CitizenFactory: L√≥gica de progress√£o baseada em IAL (N√≠vel de Garantia).
GovernanceAuditorFactory: Poder de modera√ß√£o vinculado √† integridade do Standing Social.
PlatformEngineerFactory: Autoridade absoluta e imunidade inabal√°vel.
Tradutor At√¥mico (TranslateIdentityRole): Solucionado o erro TS7053. Implementada a normaliza√ß√£o de rastro para indexar Branded Types sem perda de soberania.
B. CAMADA DE ORQUESTRA√á√ÉO NEURAL
O Juiz Sist√™mico (AiNeuralAuditor): Placeholder erradicado. Implementada a Diplomacia Neural, permitindo ao auditor escolher entre Gemini (Neg√≥cio), Claude (L√≥gica) e GPT (Seguran√ßa) em tempo real.
Sistema Imunol√≥gico (AiSelfHealing): Transmutado de simula√ß√£o para Atuador de Produ√ß√£o. O sistema agora √© capaz de disparar comandos reais de infraestrutura (CACHE_PURGE, SESSION_TERMINATION) com telemetria de lat√™ncia.
Motor de Viraliza√ß√£o (ViralEngine): Criada a C√°psula de M√≠dia Soberana. Implementamos drivers inteligentes para X, Instagram, TikTok e WhatsApp que normalizam propor√ß√µes (Media Normalizer) e injetam o Merkle Root em cada compartilhamento.
Guardi√£o de Consentimento (SovereignDiffusionGuard): √Åtomo de UI que garante que o cidad√£o autorize a difus√£o social, com sistema de bypass via cookies.
C. INTEGRA√á√ïES E PERSIST√äNCIA
√Çncora de Verdade (BlockchainLedger): Implementada a selagem de assinaturas via √Årvore de Merkle. Uso exclusivo de @noble/hashes (SHA-256), erradicando bibliotecas legadas.
Cofre Relacional (SupabaseBridge): Implementado o SecurityAuditRepository. O rastro de todos os bots e amea√ßas detectados pelo Sentinel agora √© gravado com integridade forense.
D. INTERFACE E CONVERS√ÉO (WEB-PORTAL)
Diagrama√ß√£o de Prest√≠gio: O portal foi refatorado para seguir o F-Pattern de jornalismo de elite.
SovereignJournalLayout: Implementa√ß√£o mobile-first com separa√ß√£o de RSC (Performance) e RCC (Aura Cin√©tica).
Ad-Vantage Lab: Workspace exclusivo para publicidade √©tica, permitindo a monetiza√ß√£o regional sem poluir a experi√™ncia do usu√°rio.
üß† 3. DECIS√ïES ESTRAT√âGICAS E CORRE√á√ïES CR√çTICAS
Silo de i18n Intra-Aparato: Decidimos mover todos os JSONs de tradu√ß√£o para dentro das pastas dos aparatos (/i18n/). Isso garante a Atomicidade Total e facilita o deploy de Legos individuais.
Erradica√ß√£o de Simula√ß√£o: Decretamos que o software deve estar pronto para produ√ß√£o em cada refatora√ß√£o. O uso de console.log √© agora considerado Regress√£o de Qualidade.
Zod v4 Sync: Padronizamos o uso de z.uuid(), z.ipv4() e .loose(). Estabelecemos a regra de Preced√™ncia de Modificadores: muta√ß√£o estrutural primeiro, selagem final (.readonly()) por √∫ltimo.
Sincronia de Branded Types: Para evitar a "Obsess√£o por Primitivos", cada ID ou Score (ex: ReputationScore) √© um tipo nominal. Isso impediu erros onde n√∫meros comuns tentavam entrar em c√°lculos de autoridade.
üïµÔ∏è 4. STATUS DO MONOREPO (AUDITORIA DE SA√öDE)
Foundation: [PERFECT] - 100% Selado.
Identity Domain: [PERFECT] - Saneamento conclu√≠do.
Orchestration: [EST√ÅVEL] - Motores de Intelig√™ncia operativos.
UI-Kit: [DEGRADADO] - Aten√ß√£o: Os tsconfig.json de community-ui, complaints-ui e news-ui exigem nivelamento para NodeNext e ativa√ß√£o de skipLibCheck.
üöÄ 5. CONTEXTO PARA O PR√ìXIMO SALTO
Estamos desenvolvendo o "Sistema Operacional da Cidadania". O pr√≥ximo passo √© o Editorial Workflow Engine, que transformar√° o Agentevai em uma ag√™ncia de not√≠cias aut√¥noma, onde a verdade √© verificada por IA, selada por Blockchain e distribu√≠da por um Enxame Viral.

---


